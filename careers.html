<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Careers Admin | Sourceone</title>

  <!-- Bootstrap -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link rel="icon" type="image/png" href="SourceOnebg.png" />

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root {
      --brand: #d33762;
      --bg: #0b0b0d;
      --panel: #131316;
      --card: #18181c;
      --border: #26262b;
      --text: #e5e7eb;
      --muted: #9ca3af;
    }

    body {
      background: var(--bg);
      font-family: "Inter", sans-serif;
      color: var(--text);
    }

    .admin-container {
      max-width: 1100px;
      margin: auto;
      padding: 48px 20px;
    }

    /* Header */
    .page-header {
      margin-bottom: 32px;
    }

    .page-header h2 {
      font-size: 26px;
      font-weight: 600;
      color: #ffffff;
    }

    .page-header p {
      font-size: 14px;
      color: var(--muted);
    }

    /* Panels */
    .panel {
      background: var(--panel);
      border-radius: 12px;
      padding: 28px;
      margin-bottom: 28px;
      border: 1px solid var(--border);
    }

    .panel-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .panel-title i {
      color: var(--brand);
    }

    /* Form */
    label {
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 6px;
    }

    .form-control {
      background: #0f0f13;
      border: 1px solid var(--border);
      color: var(--text);
      border-radius: 8px;
      font-size: 14px;
      padding: 10px 12px;
    }

    .form-control:focus {
      background: #0f0f13;
      border-color: var(--brand);
      box-shadow: 0 0 0 2px rgba(211,55,98,0.2);
      color: #ffffff;
    }

    textarea {
      resize: vertical;
    }

    /* Buttons */
    .btn-brand {
      background: var(--brand);
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 10px 22px;
      font-size: 14px;
    }

    .btn-brand:hover {
      background: #c02f55;
    }

    .btn-muted {
      background: transparent;
      border: 1px solid var(--border);
      color: var(--text);
      border-radius: 8px;
      padding: 10px 20px;
      font-size: 14px;
    }

    .btn-muted:hover {
      border-color: var(--brand);
      color: var(--brand);
    }

    /* ===== GRID ===== */
    .jobs-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 18px;
    }

    .job-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 18px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      transition: transform .15s ease, border-color .15s ease;
    }

    .job-card:hover {
      border-color: var(--brand);
      transform: translateY(-2px);
    }

    .job-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 4px;
      color: #ffffff;
    }

    .job-location {
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 10px;
    }

    .job-location i {
      color: var(--brand);
      margin-right: 4px;
    }

    .job-req {
      font-size: 14px;
      color: #d1d5db;
      white-space: pre-wrap;
      margin-bottom: 14px;
      flex-grow: 1;
      line-height: 1.5;
    }

    .job-actions {
      display: flex;
      gap: 10px;
    }

    .job-actions button {
      font-size: 13px;
      padding: 6px 14px;
      border-radius: 6px;
    }

    @media (max-width: 768px) {
      .job-actions {
        flex-direction: column;
      }
    }
  </style>
</head>

<body>

<div class="admin-container">

  <!-- HEADER -->
  <div class="page-header">
    <h2>Careers Management</h2>
    <p>Manage job openings displayed on the Sourceone.in website.</p>
  </div>

  <!-- FORM -->
  <div class="panel">
    <div class="panel-title">
      <i class="bi bi-briefcase"></i>
      <span id="formTitle">Add New Position</span>
    </div>

    <input type="hidden" id="jobId">

    <div class="row mb-3">
      <div class="col-md-6">
        <label>Position</label>
        <input type="text" id="position" class="form-control">
      </div>
      <div class="col-md-6">
        <label>Location</label>
        <input type="text" id="location" class="form-control">
      </div>
    </div>

    <div class="mb-4">
      <label>Requirements</label>
      <textarea id="requirements" class="form-control" rows="4"></textarea>
    </div>

    <div class="d-flex gap-2">
      <button class="btn-brand" onclick="saveJob()">Save Job</button>
      <button class="btn-muted d-none" id="cancelEdit" onclick="resetForm()">Cancel</button>
    </div>
  </div>

  <!-- GRID -->
  <div class="panel">
    <div class="panel-title">
      <i class="bi bi-grid"></i>
      <span>Existing Openings</span>
    </div>

    <div id="jobsList" class="jobs-grid"></div>
  </div>

</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyAENr32Pk-Sq44tuBPj8c_xXk4qzEa3GJw",
  authDomain: "login-9338e.firebaseapp.com",
  databaseURL: "https://login-9338e-default-rtdb.firebaseio.com",
  projectId: "login-9338e",
  storageBucket: "login-9338e.appspot.com",
  messagingSenderId: "649880075591",
  appId: "1:649880075591:web:a5cd336a03d80e9b656062",
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const positionInput = document.getElementById("position");
const locationInput = document.getElementById("location");
const requirementsInput = document.getElementById("requirements");
const jobId = document.getElementById("jobId");
const jobsList = document.getElementById("jobsList");
const formTitle = document.getElementById("formTitle");
const cancelEdit = document.getElementById("cancelEdit");

function saveJob() {
  const data = {
    position: positionInput.value.trim(),
    location: locationInput.value.trim(),
    requirements: requirementsInput.value.trim(),
    createdAt: Date.now()
  };

  if (!data.position || !data.location || !data.requirements) {
    alert("Please fill all fields");
    return;
  }

  jobId.value
    ? db.ref("jobs/" + jobId.value).update(data)
    : db.ref("jobs").push(data);

  resetForm();
}

db.ref("jobs").on("value", snap => {
  jobsList.innerHTML = "";
  snap.forEach(child => {
    const j = child.val();
    jobsList.innerHTML += `
      <div class="job-card">
        <div>
          <div class="job-title">${j.position}</div>
          <div class="job-location">
            <i class="bi bi-geo-alt"></i>${j.location}
          </div>
          <div class="job-req">${j.requirements}</div>
        </div>

        <div class="job-actions">
          <button class="btn-muted" onclick="editJob('${child.key}')">Edit</button>
          <button class="btn btn-danger btn-sm" onclick="deleteJob('${child.key}')">Delete</button>
        </div>
      </div>
    `;
  });
});

function editJob(id) {
  db.ref("jobs/" + id).once("value").then(s => {
    const j = s.val();
    jobId.value = id;
    positionInput.value = j.position;
    locationInput.value = j.location;
    requirementsInput.value = j.requirements;
    formTitle.innerText = "Edit Position";
    cancelEdit.classList.remove("d-none");
  });
}

function deleteJob(id) {
  if (confirm("Delete this job opening?")) {
    db.ref("jobs/" + id).remove();
  }
}

function resetForm() {
  jobId.value = "";
  positionInput.value = "";
  locationInput.value = "";
  requirementsInput.value = "";
  formTitle.innerText = "Add New Position";
  cancelEdit.classList.add("d-none");
}
</script>

</body>
</html>
